    Encrypted SSH keys generated by a RHEL 6 system in FIPS mode (and presumably other versions of RHEL/Fedora) automatically use an alternate PKCS8 format that doesn't make use of MD5. This isn't mentioned anywhere in the RHEL 6 ssh-keygen man page; however, newer versions (e.g., RHEL 7) have a -m option that let's you explicitly set the format ... but only works when you're doing import/export and I think it doesn't work with encrypted keys so I didn't even go down that hole.

    To be clear, encrypted SSH keys generated with default options by every version of ssh-keygen currently available in RHEL & Fedora will be unusable in FIPS mode.

    You can read in a standard key (on a non-FIPS system) and convert it to FIPS-compatible PKCS8 format by using the following command:
    Raw

    openssl pkcs8 -topk8 -v2 aes128 -in id_rsa -out new-id_rsa

    Note that if you pass it an encrypted key, it will prompt for the current password as well as giving you the option to type a password for encryption of the new key. (Of course there's also -passin and -passout if you don't mind leaking your secrets to the rest of the system.)


openssl pkcs8 -topk8 -v2 aes128 -in id_rsa -out new-id_rsa


